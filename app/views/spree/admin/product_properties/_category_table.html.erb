<% cat_table = category.try(:name) || "uncategorized" %>
<table class="index sortable" data-hook data-sortable-link="<%= update_positions_admin_product_product_properties_url %>">
  <thead>
    <tr data-hook="category_table_header">
      <th colspan="2">
        <%= category ? "#{category.name} Category" : "Uncategorized" %>
      </th>
      <th>
        <% target = "tbody#product_properties_#{cat_table}" %>
        <% category_name = category.try(:name) %>
        <%= link_to_with_icon('plus',
                              Spree.t(:add_properties),
                              'javascript:',
                              data: { target: target, category_name: category_name},
                              class: "plus button add-property-field") %>
      </th>

    <tr data-hook="product_properties_header">
      <th colspan="2"><%= Spree.t(:property) %></th>
      <th><%= Spree.t(:value) %></th>
      <th class="actions"></th>
    </tr>
  </thead>
  <tbody id="product_properties_<%= cat_table %>" data-hook>
    <%= f.fields_for :product_properties, properties do |pp_form| %>
      <%= render 'product_property_fields', form: pp_form, category: category %>
    <% end %>
  </tbody>
</table>
